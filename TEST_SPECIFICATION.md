# DAINAGE Toggl Clone - テスト仕様書

## 概要

DAINAGE Toggl Cloneアプリケーションの全機能に対する包括的なテスト仕様書です。
開発チーム特化の時間管理ツールとして、信頼性と品質を保証するためのテストケースを定義します。

## テスト環境

- **テストフレームワーク**: Jest + React Testing Library
- **テスト環境**: jsdom (Node.js環境でのブラウザシミュレーション)
- **モック**: Supabase、Next.js Router、認証機能
- **カバレッジターゲット**: 80%以上

## 1. 認証機能のテスト

### 1.1 Google OAuth認証

**テストケース**: `AUTH-001`
- **説明**: Google OAuthログインが正常に動作する
- **前提条件**: ユーザーが未認証状態
- **テスト手順**:
  1. ランディングページにアクセス
  2. 「Google でログイン」ボタンをクリック
  3. Google OAuth認証画面が表示される
  4. 認証成功後、ダッシュボードにリダイレクト
- **期待結果**: ユーザーがダッシュボードに正常にログインできる

**テストケース**: `AUTH-002`
- **説明**: 認証状態の永続化
- **前提条件**: ユーザーがログイン済み
- **テスト手順**:
  1. ページを再読み込み
  2. 認証状態が保持されているか確認
- **期待結果**: 再読み込み後もログイン状態が維持される

### 1.2 ログアウト機能

**テストケース**: `AUTH-003`
- **説明**: ログアウトが正常に動作する
- **前提条件**: ユーザーがログイン済み
- **テスト手順**:
  1. ダッシュボードでログアウトボタンをクリック
  2. ランディングページにリダイレクト
- **期待結果**: ユーザーが正常にログアウトされる

## 2. タイマー機能のテスト

### 2.1 基本タイマー操作

**テストケース**: `TIMER-001`
- **説明**: タイマーの開始と停止
- **前提条件**: ユーザーがログイン済み、プロジェクトが存在
- **テスト手順**:
  1. プロジェクトを選択
  2. 説明を入力（任意）
  3. 「開始」ボタンをクリック
  4. タイマーが開始されることを確認
  5. 「停止」ボタンをクリック
  6. タイマーが停止し、時間エントリが保存される
- **期待結果**: タイマーが正常に開始・停止し、時間が記録される

**テストケース**: `TIMER-002`
- **説明**: タイマー表示の更新
- **前提条件**: タイマーが実行中
- **テスト手順**:
  1. タイマー開始
  2. 1秒待機
  3. 表示時間が更新されるか確認
- **期待結果**: タイマー表示が1秒ごとに更新される

### 2.2 プロジェクト選択

**テストケース**: `TIMER-003`
- **説明**: プロジェクト選択機能
- **前提条件**: 複数のプロジェクトが存在
- **テスト手順**:
  1. プロジェクト選択ドロップダウンを開く
  2. プロジェクトリストが表示される
  3. プロジェクトを選択
  4. 選択されたプロジェクトが表示される
- **期待結果**: プロジェクト選択が正常に動作する

**テストケース**: `TIMER-004`
- **説明**: プロジェクト未選択時の開始ボタン無効化
- **前提条件**: プロジェクトが未選択
- **テスト手順**:
  1. プロジェクトを選択せずに開始ボタンを確認
- **期待結果**: 開始ボタンが無効状態になっている

### 2.3 テストモード

**テストケース**: `TIMER-005`
- **説明**: 未ログイン時のテストタイマー
- **前提条件**: ユーザーが未ログイン
- **テスト手順**:
  1. ランディングページでテストタイマーを確認
  2. ダミープロジェクトが表示される
  3. タイマーが動作する
- **期待結果**: 未ログインでもタイマー機能をテストできる

## 3. プロジェクト管理機能のテスト

### 3.1 プロジェクトCRUD操作

**テストケース**: `PROJECT-001`
- **説明**: プロジェクト作成
- **前提条件**: ユーザーがログイン済み
- **テスト手順**:
  1. 「新規プロジェクト」ボタンをクリック
  2. プロジェクト名、説明、色を入力
  3. 「作成」ボタンをクリック
- **期待結果**: 新しいプロジェクトが作成される

**テストケース**: `PROJECT-002`
- **説明**: プロジェクト編集
- **前提条件**: プロジェクトが存在
- **テスト手順**:
  1. プロジェクトの編集ボタンをクリック
  2. プロジェクト情報を変更
  3. 保存
- **期待結果**: プロジェクト情報が更新される

**テストケース**: `PROJECT-003`
- **説明**: プロジェクト削除
- **前提条件**: プロジェクトが存在
- **テスト手順**:
  1. プロジェクトの削除ボタンをクリック
  2. 確認ダイアログで削除を確認
- **期待結果**: プロジェクトが削除される

### 3.2 プロジェクト表示

**テストケース**: `PROJECT-004`
- **説明**: プロジェクト一覧表示
- **前提条件**: 複数のプロジェクトが存在
- **テスト手順**:
  1. プロジェクト一覧ページにアクセス
- **期待結果**: 全プロジェクトが一覧表示される

**テストケース**: `PROJECT-005`
- **説明**: プロジェクト統計表示
- **前提条件**: プロジェクトに時間エントリが存在
- **テスト手順**:
  1. プロジェクト詳細を確認
- **期待結果**: 総時間、タスク数などの統計が表示される

## 4. 時間エントリ管理のテスト

### 4.1 時間エントリ表示

**テストケース**: `ENTRY-001`
- **説明**: 時間エントリ一覧表示
- **前提条件**: 時間エントリが存在
- **テスト手順**:
  1. 時間エントリ一覧ページにアクセス
- **期待結果**: 時間エントリが日付順で表示される

### 4.2 時間エントリ編集

**テストケース**: `ENTRY-002`
- **説明**: 時間エントリの手動編集
- **前提条件**: 時間エントリが存在
- **テスト手順**:
  1. 時間エントリの編集ボタンをクリック
  2. 開始時間、終了時間、説明を変更
  3. 保存
- **期待結果**: 時間エントリが更新される

**テストケース**: `ENTRY-003`
- **説明**: 時間エントリの削除
- **前提条件**: 時間エントリが存在
- **テスト手順**:
  1. 時間エントリの削除ボタンをクリック
  2. 確認ダイアログで削除を確認
- **期待結果**: 時間エントリが削除される

## 5. レポート・アナリティクス機能のテスト

### 5.1 レポート表示

**テストケース**: `REPORT-001`
- **説明**: 日別レポート表示
- **前提条件**: 時間エントリが存在
- **テスト手順**:
  1. レポートページにアクセス
  2. 日別ビューを選択
- **期待結果**: 日別の時間統計が表示される

**テストケース**: `REPORT-002`
- **説明**: プロジェクト別レポート
- **前提条件**: 複数プロジェクトに時間エントリが存在
- **テスト手順**:
  1. プロジェクト別ビューを選択
- **期待結果**: プロジェクト別の時間分布が表示される

### 5.2 データエクスポート

**テストケース**: `REPORT-003`
- **説明**: CSVエクスポート機能
- **前提条件**: 時間エントリが存在
- **テスト手順**:
  1. 「CSVエクスポート」ボタンをクリック
- **期待結果**: 時間データがCSV形式でダウンロードされる

## 6. チーム管理機能のテスト

### 6.1 チーム作成・管理

**テストケース**: `TEAM-001`
- **説明**: チーム作成
- **前提条件**: ユーザーがログイン済み
- **テスト手順**:
  1. 「新規チーム」ボタンをクリック
  2. チーム名、説明を入力
  3. 保存
- **期待結果**: 新しいチームが作成される

**テストケース**: `TEAM-002`
- **説明**: チームメンバー招待
- **前提条件**: チームが存在
- **テスト手順**:
  1. 「メンバー招待」ボタンをクリック
  2. メールアドレスを入力
  3. 招待送信
- **期待結果**: 招待メールが送信される

### 6.2 チーム統計

**テストケース**: `TEAM-003`
- **説明**: チーム統計表示
- **前提条件**: チームメンバーの時間エントリが存在
- **テスト手順**:
  1. チーム統計ページにアクセス
- **期待結果**: チーム全体の時間統計が表示される

## 7. スプリント管理機能のテスト

### 7.1 スプリント作成・管理

**テストケース**: `SPRINT-001`
- **説明**: スプリント作成
- **前提条件**: プロジェクトが存在
- **テスト手順**:
  1. 「新規スプリント」ボタンをクリック
  2. スプリント名、期間、目標を入力
  3. 保存
- **期待結果**: 新しいスプリントが作成される

**テストケース**: `SPRINT-002`
- **説明**: スプリントタスク管理
- **前提条件**: スプリントが存在
- **テスト手順**:
  1. スプリントにタスクを追加
  2. タスクの見積もり時間を設定
- **期待結果**: タスクがスプリントに追加される

### 7.2 ベロシティ計算

**テストケース**: `SPRINT-003`
- **説明**: ベロシティ計算
- **前提条件**: 完了したスプリントが存在
- **テスト手順**:
  1. ベロシティレポートを確認
- **期待結果**: スプリントベロシティが正確に計算される

## 8. Git連携機能のテスト

### 8.1 リポジトリ連携

**テストケース**: `GIT-001`
- **説明**: GitHubリポジトリ連携
- **前提条件**: GitHubアカウントが連携済み
- **テスト手順**:
  1. 「リポジトリ連携」をクリック
  2. リポジトリを選択
  3. 連携保存
- **期待結果**: リポジトリが正常に連携される

**テストケース**: `GIT-002`
- **説明**: コミット時間追跡
- **前提条件**: Git連携が設定済み
- **テスト手順**:
  1. タイマー開始
  2. ブランチ名を入力
  3. コミット実行
- **期待結果**: コミットと時間エントリが関連付けられる

## 9. 設定機能のテスト

### 9.1 ユーザー設定

**テストケース**: `SETTINGS-001`
- **説明**: プロフィール編集
- **前提条件**: ユーザーがログイン済み
- **テスト手順**:
  1. 設定ページにアクセス
  2. 名前、タイムゾーンを変更
  3. 保存
- **期待結果**: プロフィール情報が更新される

**テストケース**: `SETTINGS-002`
- **説明**: 通知設定
- **前提条件**: ユーザーがログイン済み
- **テスト手順**:
  1. 通知設定を変更
  2. 保存
- **期待結果**: 通知設定が更新される

### 9.2 システム設定

**テストケース**: `SETTINGS-003`
- **説明**: ダークモード切り替え
- **前提条件**: アプリケーションにアクセス
- **テスト手順**:
  1. ダークモード切り替えボタンをクリック
- **期待結果**: ダークモードが有効/無効切り替わる

## 10. パフォーマンステスト

### 10.1 応答時間

**テストケース**: `PERF-001`
- **説明**: ページ読み込み時間
- **測定項目**:
  - ダッシュボード読み込み: < 2秒
  - レポート生成: < 3秒
  - タイマー開始/停止: < 500ms

### 10.2 データ処理

**テストケース**: `PERF-002`
- **説明**: 大量データ処理
- **前提条件**: 1000件以上の時間エントリが存在
- **テスト手順**:
  1. 年間レポートを生成
- **期待結果**: 10秒以内でレポートが生成される

## 11. セキュリティテスト

### 11.1 認証セキュリティ

**テストケース**: `SEC-001`
- **説明**: 未認証アクセス制御
- **テスト手順**:
  1. 未ログイン状態でダッシュボードにアクセス
- **期待結果**: ログインページにリダイレクトされる

**テストケース**: `SEC-002`
- **説明**: セッションタイムアウト
- **テスト手順**:
  1. 長時間非アクティブ状態
  2. API呼び出し実行
- **期待結果**: セッション期限切れエラーが表示される

### 11.2 データセキュリティ

**テストケース**: `SEC-003`
- **説明**: ユーザーデータ分離
- **テスト手順**:
  1. ユーザーAでログイン
  2. ユーザーBのデータにアクセス試行
- **期待結果**: アクセスが拒否される

## 12. ユーザビリティテスト

### 12.1 レスポンシブデザイン

**テストケース**: `UI-001`
- **説明**: モバイル対応
- **テスト手順**:
  1. モバイルサイズでアクセス
  2. 全機能を確認
- **期待結果**: モバイルで正常に操作できる

**テストケース**: `UI-002`
- **説明**: アクセシビリティ
- **テスト手順**:
  1. キーボードナビゲーション
  2. スクリーンリーダー対応
- **期待結果**: アクセシビリティ基準を満たす

## 13. エラーハンドリングテスト

### 13.1 ネットワークエラー

**テストケース**: `ERROR-001`
- **説明**: オフライン時の動作
- **テスト手順**:
  1. ネットワーク切断
  2. タイマー操作実行
- **期待結果**: 適切なエラーメッセージが表示される

**テストケース**: `ERROR-002`
- **説明**: サーバーエラー処理
- **テスト手順**:
  1. サーバーエラーを発生
  2. ユーザー操作実行
- **期待結果**: エラーが適切にハンドリングされる

## 14. データ整合性テスト

### 14.1 時間計算

**テストケース**: `DATA-001`
- **説明**: 時間計算の正確性
- **テスト手順**:
  1. 複数の時間エントリを作成
  2. 合計時間を確認
- **期待結果**: 時間計算が正確に行われる

**テストケース**: `DATA-002`
- **説明**: データ同期
- **テスト手順**:
  1. 複数デバイスで同じアカウントにログイン
  2. データ変更を確認
- **期待結果**: リアルタイムでデータが同期される

## 15. 自動化テスト実行

### 15.1 継続的インテグレーション

- **単体テスト**: 各コンポーネント、フック、ユーティリティ
- **統合テスト**: API呼び出し、データフロー
- **E2Eテスト**: 主要ユーザーフロー
- **回帰テスト**: 機能追加時の既存機能確認

### 15.2 テストカバレッジ目標

- **単体テスト**: 90%以上
- **統合テスト**: 80%以上
- **E2Eテスト**: 主要フロー100%

## 実装ステータス

### ✅ 実装済み
- 基本的なタイマー機能テスト
- プロジェクト管理テスト
- Supabaseクライアント関数テスト
- Jest設定とモック

### 🚧 実装中
- コンポーネントテストの修正
- 統合テストの追加

### ❌ 未実装
- E2Eテスト (Playwright/Cypress)
- パフォーマンステスト
- セキュリティテスト自動化
- アクセシビリティテスト

この仕様書に基づいて、段階的にテストケースを実装し、アプリケーションの品質を向上させていきます。